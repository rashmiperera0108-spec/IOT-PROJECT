<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IoT Sensor Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f8f9fa; }
    h2 { margin-top: 20px; }
    .dashboard { display: flex; justify-content: center; gap: 20px; margin: 20px; }
    .card {
      background: white; padding: 20px; border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 150px; text-align: center;
    }
    .value { font-size: 22px; font-weight: bold; color: #007BFF; }

    /* Toggle button */
    .switch {
      position: relative; display: inline-block;
      width: 60px; height: 34px;
    }
    .switch input { display: none; }
    .slider {
      position: absolute; cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc; transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute; content: "";
      height: 26px; width: 26px;
      left: 4px; bottom: 4px;
      background-color: white; transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider { background-color: #28a745; }
    input:checked + .slider:before { transform: translateX(26px); }
  </style>
</head>
<body>
  <h2>IoT Sensor Dashboard</h2>

  <div class="dashboard">
    <div class="card">
      <h3>Humidity</h3>
      <p class="value" id="humidity">-- %</p>
    </div>

    <div class="card">
      <h3>Temperature</h3>
      <p class="value" id="temperature">-- °C</p>
    </div>
  </div>

  <div class="card" style="margin:auto;">
    <h3>LED Control</h3>
    <label class="switch">
      <input type="checkbox" id="ledToggle" onchange="toggleLED()">
      <span class="slider"></span>
    </label>
  </div>

  <script>
    // Example: Replace with your ESP32 endpoint
    const deviceIP = "http://192.168.1.100"; // <-- change to your ESP32 IP

    // Fetch sensor data
    async function fetchData() {
      try {
        let response = await fetch(deviceIP + "/sensor");
        let data = await response.json();
        document.getElementById("humidity").innerText = data.humidity + " %";
        document.getElementById("temperature").innerText = data.temperature + " °C";
      } catch (err) {
        console.error("Error fetching data:", err);
      }
    }

    // Toggle LED
    function toggleLED() {
      let state = document.getElementById("ledToggle").checked ? "on" : "off";
      fetch(deviceIP + "/led?state=" + state);
    }

    // Update every 2s
    setInterval(fetchData, 2000);
  </script>
</body>
</html>